<!DOCTYPE html>
{% load tz %}
<html>
<head>
    <meta charset="UTF-8">
    <style>
        @page { size: A4; margin: 2cm; }
        body { font-family: Georgia, 'Times New Roman', Times, serif; font-size: 12pt; color: #111827; }
        /* Make layout adapt when rendered inside narrow preview sidebar */
        .header, .company-info, .invoice-info { box-sizing: border-box; }
        @media(max-width:480px){
            .company-info, .invoice-info { float:none !important; width:100% !important; text-align:left !important; }
            .totals { float:none !important; width:100% !important; margin-top:8px !important; }
            table th, table td { padding:6px; font-size:10pt; }
            .invoice-number { display:block; margin-top:8px; }
        }
        .header { margin-bottom: 22px; padding-bottom: 10px; }
        .company-info { float:right; width:35%; text-align:right; }
        .invoice-info { float:left; width:60%; }
        .invoice-number { background:#111827; color:#fff; padding:6px 10px; display:inline-block; border-radius:4px; }
        table { width:100%; border-collapse:collapse; margin-top:14px; }
        table th { text-align:left; padding:10px; border-bottom:1px solid #e5e7eb; }
        table td { padding:10px; border-bottom:1px solid #f3f4f6; }
        .totals { float:right; width:38%; margin-top:12px; }
        .footer { margin-top:30px; text-align:center; color:#6b7280; }
    </style>
</head>
<body>
    {% if invoice and business %}
    <div class="header clearfix">
        <div class="company-info">
            {% if business.logo %}
                <img src="{{ business.logo.url }}" style="max-width:140px; max-height:80px;" alt="Logo">
            {% endif %}
            <div style="margin-top:6px; font-weight:700;">{{ business.business_name }}</div>
        </div>
        <div class="invoice-info" style="text-align:right;">
            <h1 style="margin:0;">INVOICE</h1>
            <p style="margin:6px 0 0 0;">Date: {{ invoice.invoice_date }} &nbsp; Due: {{ invoice.due_date }}</p>
            <div style="margin-top:6px; font-weight:700;">#{{ invoice.invoice_number }}</div>
        </div>
    </div>
    {% endif %}

    <div class="client-info"><strong>Bill To:</strong><br>{% if invoice.client_name %}{{ invoice.client_name }}{% else %}{{ invoice.client.name }}{% endif %}</div>

    <table>
        <thead><tr><th>Description</th><th style="width:12%;text-align:right;">Qty</th><th style="width:20%;text-align:right;">Unit</th><th style="width:20%;text-align:right;">Total</th></tr></thead>
        <tbody>
            {% if invoice and invoice.items.exists %}
                {% for item in invoice.items.all %}
                <tr>
                    <td>{{ item.description }}</td>
                    <td style="text-align:right;">{{ item.quantity }}</td>
                    <td style="text-align:right;">{{ invoice.currency }} {{ item.unit_price }}</td>
                    <td style="text-align:right;">{{ invoice.currency }} {{ item.line_total }}</td>
                </tr>
                {% endfor %}
            {% else %}
                <tr><td colspan="4" style="text-align:center;padding:20px;color:#9ca3af;">No items</td></tr>
            {% endif %}
        </tbody>
    </table>

    <div class="totals">
        <table>
            <tr><td>Subtotal:</td><td style="text-align:right;">{{ invoice.currency }} {{ invoice.subtotal }}</td></tr>
            <tr><td>Tax:</td><td style="text-align:right;">{{ invoice.currency }} {{ invoice.tax_amount }}</td></tr>
            <tr style="font-weight:700;"><td>Total:</td><td style="text-align:right;">{{ invoice.currency }} {{ invoice.total_amount }}</td></tr>
        </table>
    </div>

    <div style="clear:both;"></div>
    <div class="footer">Template 3 â€” Minimal (classic serif)</div>
</body>
</html>
